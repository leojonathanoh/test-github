name: ci-master-pr

on:
  push:
    branches:
    - '**'
    tags:
    - '**'
  pull_request:
    branches:
    - master

jobs:
  docker:
    runs-on: ubuntu-latest
    steps:
      -
        name: Checkout
        uses: actions/checkout@v3
      -
        name: Docker meta (release)
        id: meta-release
        uses: docker/metadata-action@v4
        with:
          images: |
            name/app
            name2/app
          tags: |
            # TODO: Remove this before merging PR
            type=ref,event=pr
            # On main. E.g. main-abc01234
            type=ref,suffix=-{{sha}},event=branch
            # On tags. E.g. 'v0', 'v0.0', 'v0.0.0', and 'latest'
            type=semver,pattern=v{{major}}
            type=semver,pattern=v{{major}}.{{minor}}
            type=semver,pattern=v{{major}}.{{minor}}.{{patch}}

